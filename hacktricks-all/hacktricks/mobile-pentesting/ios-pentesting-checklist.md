# iOS Pentesting Checklist

### Preparation

- [ ] Read [**iOS Basics**](ios-pentesting/ios-basics.md)
- [ ] Prepare your environment reading [**iOS Testing Environment**](ios-pentesting/ios-testing-environment.md)
- [ ] Read all the sections of [[ios-pentesting/README.md#Initial Analysis|iOS Initial Analysis]] to learn common actions to pentest an iOS application

### Data Storage

- [ ] [[ios-pentesting/README.md#Plist|Plist files]] can be used to store sensitive information.
- [ ] [[ios-pentesting/README.md#Core Data|Core Data]] (SQLite database) can store sensitive information.
- [ ] [[ios-pentesting/README.md#Yapdatabase|YapDatabases]] (SQLite database) can store sensitive information.
- [ ] [[ios-pentesting/README.md#Firebase Real Time Databases|Firebase]] miss-configuration.
- [ ] [[ios-pentesting/README.md#Realm Databases|Realm databases]] can store sensitive information.
- [ ] [[ios-pentesting/README.md#Couchbase Lite Databases|Couchbase Lite databases]] can store sensitive information.
- [ ] [[ios-pentesting/README.md#Cookies|Binary cookies]] can store sensitive information
- [ ] [[ios-pentesting/README.md#Cache|Cache data]] can store sensitive information
- [ ] [[ios-pentesting/README.md#Snapshots|Automatic snapshots]] can save visual sensitive information
- [ ] [[ios-pentesting/README.md#Keychain|Keychain]] is usually used to store sensitive information that can be left when reselling the phone.
- [ ] In summary, just **check for sensitive information saved by the application in the filesystem**

### Keyboards

- [ ] Does the application [[ios-pentesting/README.md#Custom Keyboards Keyboard Cache|allow to use custom keyboards]]?
- [ ] Check if sensitive information is saved in the [[ios-pentesting/README.md#Custom Keyboards Keyboard Cache|keyboards cache files]]

### **Logs**

- [ ] Check if [[ios-pentesting/README.md#Logs|sensitive information is being logged]]

### Backups

- [ ] [[ios-pentesting/README.md#Backups|Backups]] can be used to **access the sensitive information** saved in the file system (check the initial point of this checklist)
- [ ] Also, [[ios-pentesting/README.md#Backups|backups]] can be used to **modify some configurations of the application**, then **restore** the backup on the phone, and the as the **modified configuration** is **loaded** some (security) **functionality** may be **bypassed**

### **Applications Memory**

- [ ] Check for sensitive information inside the [[ios-pentesting/README.md#Testing Memory For Sensitive Data|application's memory]]

### **Broken Cryptography**

- [ ] Check if yo can find [[ios-pentesting/README.md#Broken Cryptography|passwords used for cryptography]]
- [ ] Check for the use of [[ios-pentesting/README.md#Broken Cryptography|deprecated/weak algorithms]] to send/store sensitive data
- [ ] [[ios-pentesting/README.md#Broken Cryptography|Hook and monitor cryptography functions]]

### **Local Authentication**

- [ ] If a [[ios-pentesting/README.md#Local Authentication|local authentication]] is used in the application, you should check how the authentication is working.
  - [ ] If it's using the [[ios-pentesting/README.md#Local Authentication Framework|Local Authentication Framework]] it could be easily bypassed
  - [ ] If it's using a [[ios-pentesting/README.md#Local Authentication Using Keychain|function that can dynamically bypassed]] you could create a custom frida script

### Sensitive Functionality Exposure Through IPC

- [[ios-pentesting/README.md#Custom Uri Handlers Deeplinks Custom Schemes|Custom URI Handlers / Deeplinks / Custom Schemes]]
  - [ ] Check if the application is **registering any protocol/scheme**
  - [ ] Check if the application is **registering to use** any protocol/scheme
  - [ ] Check if the application **expects to receive any kind of sensitive information** from the custom scheme that can be **intercepted** by the another application registering the same scheme
  - [ ] Check if the application **isn't checking and sanitizing** users input via the custom scheme and some **vulnerability can be exploited**
  - [ ] Check if the application **exposes any sensitive action** that can be called from anywhere via the custom scheme
- [[ios-pentesting/README.md#Universal Links|Universal Links]]
  - [ ] Check if the application is **registering any universal protocol/scheme**
  - [ ] Check the `apple-app-site-association` file
  - [ ] Check if the application **isn't checking and sanitizing** users input via the custom scheme and some **vulnerability can be exploited**
  - [ ] Check if the application **exposes any sensitive action** that can be called from anywhere via the custom scheme
- [**UIActivity Sharing**](ios-pentesting/ios-uiactivity-sharing.md)
  - [ ] Check if the application can receive UIActivities and if it's possible to exploit any vulnerability with specially crafted activity
- [**UIPasteboard**](ios-pentesting/ios-uipasteboard.md)
  - [ ] Check if the application if **copying anything to the general pasteboard**
  - [ ] Check if the application if **using the data from the general pasteboard for anything**
  - [ ] Monitor the pasteboard to see if any **sensitive data is copied**
- [**App Extensions**](ios-pentesting/ios-app-extensions.md)
  - [ ] Is the application **using any extension**?
- [**WebViews**](ios-pentesting/ios-webviews.md)
  - [ ] Check which kind of webviews are being used
  - [ ] Check the status of **`javaScriptEnabled`**, **`JavaScriptCanOpenWindowsAutomatically`**, **`hasOnlySecureContent`**
  - [ ] Check if the webview can **access local files** with the protocol **file://** **(**`allowFileAccessFromFileURLs`, `allowUniversalAccessFromFileURLs`)
  - [ ] Check if Javascript can access **Native** **methods** (`JSContext`, `postMessage`)

### Network Communication

- [ ] Perform a [[ios-pentesting/README.md#Network Communication|MitM to the communication]] and search for web vulnerabilities.
- [ ] Check if the [[ios-pentesting/README.md#Hostname Check|hostname of the certificate]] is checked
- [ ] Check/Bypass [[ios-pentesting/README.md#Certificate Pinning|Certificate Pinning]]

### **Misc**

- [ ] Check for [[ios-pentesting/README.md#Hot Patching Enforced Updateing|automatic patching/updating]] mechanisms
- [ ] Check for [[ios-pentesting/README.md#Third Parties|malicious third party libraries]]

