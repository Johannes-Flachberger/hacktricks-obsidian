# GCP - Secretmanager Privesc

## secretmanager

For more information about secretmanager:

[[../gcp-services/gcp-secrets-manager-enum.md]]

### `secretmanager.versions.access`

This give you access to read the secrets from the secret manager and maybe this could help to escalate privielegs (depending on which information is sotred inside the secret):

<details>**Get clear\-text secret version**

```bash
# Get clear-text of version 1 of secret: "<secret name>"
gcloud secrets versions access 1 --secret="<secret_name>"
```

</details>

As this is also a post exploitation technique it can be found in:

[[../gcp-post-exploitation/gcp-secretmanager-post-exploitation.md]]

### `secretmanager.secrets.setIamPolicy`

This give you access to give you access to read the secrets from the secret manager, like using:

<details>**Add IAM policy binding to secret**

```bash
gcloud secrets add-iam-policy-binding <scret-name> \
  --member="serviceAccount:<sa-name>@$PROJECT_ID.iam.gserviceaccount.com" \
  --role="roles/secretmanager.secretAccessor"
```

</details>

